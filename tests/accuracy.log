[Request] parsed /mnt/workspace/acestep.cpp/tests/ggml-turbo/request.json (10 fields)
[Request] task=text2music thinking=false seed=42
  caption:    Upbeat pop rock anthem with driving electric guitars, punchy...
  lyrics:     149 bytes
  bpm=120 dur=120 key= ts= lang=en
  lm: temp=0.85 cfg=2.0 top_p=0.90
  dit: steps=8 guidance=0.0 shift=3.0
  audio_codes: (none)
[Pipeline] No codes, text-to-music from noise
ggml_cuda_init: found 1 CUDA devices:
  Device 0: NVIDIA RTX PRO 6000 Blackwell Workstation Edition, compute capability 12.0, VMM: yes
[Load] DiT backend: CUDA0
[Load] Backend init: 12.4 ms
[Safetensors] /mnt/workspace/acestep.cpp/checkpoints/acestep-v15-turbo/model.safetensors: 677 tensors
[Load] DiT safetensors: 677 tensors
[Load] null_condition_emb found (CFG available)
[Safetensors] Loaded 477 tensors, 3005.0 MB into backend
[Load] DiT: 24 layers, H=2048, Nh=16/8, D=128
[Load] DiT weight load: 761.6 ms
[Pipeline] shift=3.0 steps=8: 1.0000 0.9545 0.9000 0.8333 0.7500 0.6429 0.5000 0.3000 
[Pipeline] duration=120.0s, T=3000, S=1500
[BPE] Loaded: 151643 vocab, 151387 merges
[Load] BPE tokenizer: 33.9 ms
[Pipeline] caption: 79 tokens, lyrics: 47 tokens
[Load] TextEncoder backend: CUDA0
[Safetensors] /mnt/workspace/acestep.cpp/checkpoints/Qwen3-Embedding-0.6B/model.safetensors: 310 tensors
[Load] Qwen3 safetensors: 310 tensors
[Safetensors] Loaded 310 tensors, 1136.4 MB into backend
[Load] TextEncoder: 28L, H=1024, Nh=16/8
[Load] TextEncoder: 116.5 ms
[Encode] TextEncoder (79 tokens): 66.4 ms
[Debug] text_hidden: [79, 1024] first4: 3.655793 1.049502 0.218936 -13.003498
[Safetensors] /mnt/workspace/acestep.cpp/checkpoints/Qwen3-Embedding-0.6B/model.safetensors: 310 tensors
[Encode] Lyric vocab lookup (47 tokens): 0.4 ms
[Debug] lyric_embed: [47, 1024] first4: 0.029175 0.032227 -0.022339 -0.028809
[Load] CondEncoder backend: CUDA0
[Safetensors] /mnt/workspace/acestep.cpp/checkpoints/acestep-v15-turbo/model.safetensors: 677 tensors
[Safetensors] Loaded 140 tensors, 1160.4 MB into backend
[Load] CondEncoder: lyric(8L), timbre(4L), text_proj, null_cond
[Load] ConditionEncoder: 335.8 ms
[Encode] Packed: lyric=47 + timbre=1 + text=79 = 127 tokens
[Encode] ConditionEncoder: 15.9 ms
[Debug] enc_hidden: [127, 2048] first4: 0.690488 -0.102838 -0.123505 0.014012
[Context] loaded silence_latent: [15000, 64] (using first 3000 frames)
[Context] loaded noise from /mnt/workspace/acestep.cpp/tests/rng_philox_seed42.bf16: [3000, 64] bf16 (time-major, T_file=3000)
[Context] context: [3000, 128], noise: [3000, 64], enc: [127, 2048]
[Debug] noise: [3000, 64] first4: 0.194336 2.156250 -0.171875 0.847656
[Debug] context: [3000, 128] first4: 0.570690 0.098214 0.690920 -0.565790
[DiT] Starting flow matching: T=3000, S=1500, enc_S=127, steps=8
[DiT] Graph: 1764 nodes
[Debug] tproj: [12288] first4: 0.260063 -0.161562 -0.097031 0.052313
[Debug] temb: [2048] first4: 0.000069 -0.132499 -0.035431 0.064754
[Debug] temb_t: [2048] first4: 0.001065 0.026818 -0.052754 0.063717
[Debug] temb_r: [2048] first4: -0.000996 -0.159317 0.017323 0.001036
[Debug] sinusoidal_t: [256] first4: 0.562379 0.789627 0.439928 -0.023645
[Debug] sinusoidal_r: [256] first4: 1.000000 1.000000 1.000000 1.000000
[Debug] temb_lin1_t: [2048] first4: -0.049319 -0.051829 -0.014252 -0.038444
[Debug] temb_lin1_r: [2048] first4: -0.013266 -0.018319 -0.016375 0.008532
[Debug] hidden_after_proj_in: [2048, 1500] first4: -0.201660 0.160095 -0.267334 0.178192
[Debug] proj_in_input: [192, 3000] first4: 0.570690 0.098214 0.690920 -0.565790
[Debug] enc_after_cond_emb: [2048, 127] first4: -0.033813 -0.042313 0.086487 -0.231140
[Debug] layer0_sa_input: [2048, 1500] first4: 0.133599 -0.104416 -0.143646 0.140501
[Debug] layer0_q_after_rope: [128, 24000] first4: -0.208828 -0.106110 0.294189 0.696715
[Debug] layer0_k_after_rope: [128, 12000] first4: -0.229159 -0.287352 0.215514 -0.389123
[Debug] layer0_sa_output: [2048, 1500] first4: -1.023438 0.414062 -0.585938 0.181641
[Debug] layer0_attn_out: [2048, 1500] first4: -0.543352 -0.023552 -0.839463 0.181501
[Debug] layer0_after_self_attn: [2048, 1500] first4: -0.543352 -0.023552 -0.839463 0.181501
[Debug] layer0_after_cross_attn: [2048, 1500] first4: -0.711320 0.283088 -1.206651 0.087263
[Debug] hidden_after_layer0: [2048, 1500] first4: -14.875305 3.795210 113.519333 -2.087030
[Debug] hidden_after_layer6: [2048, 1500] first4: -17.842545 -10.817772 71.403999 2.215467
[Debug] hidden_after_layer12: [2048, 1500] first4: -15.947386 -9.644729 69.729683 26.351334
[Debug] hidden_after_layer18: [2048, 1500] first4: -34.005272 23.384144 -5.441862 10.000948
[Debug] hidden_after_layer23: [2048, 1500] first4: -61.472595 -27.874310 78.852196 167.520874
[Debug] dit_step0_vt: [3000, 64] first4: -0.048706 0.959229 -0.539429 2.046631
[Debug] dit_step0_xt: [3000, 64] first4: 0.196550 2.112649 -0.147355 0.754628
[DiT] step 1/8 t=1.000
[Debug] dit_step1_vt: [3000, 64] first4: -0.202026 2.072510 -1.281616 1.984131
[Debug] dit_step1_xt: [3000, 64] first4: 0.207569 1.999603 -0.077449 0.646402
[DiT] step 2/8 t=0.955
[Debug] dit_step2_vt: [3000, 64] first4: -0.070190 1.853760 -1.312866 2.421631
[Debug] dit_step2_xt: [3000, 64] first4: 0.212249 1.876019 0.010075 0.484960
[DiT] step 3/8 t=0.900
[Debug] dit_step3_vt: [3000, 64] first4: -0.399292 2.463135 -1.414429 2.077881
[Debug] dit_step3_xt: [3000, 64] first4: 0.245523 1.670757 0.127944 0.311803
[DiT] step 4/8 t=0.833
[Debug] dit_step4_vt: [3000, 64] first4: -0.465698 2.306885 -1.140991 1.656006
[Debug] dit_step4_xt: [3000, 64] first4: 0.295419 1.423591 0.250193 0.134374
[DiT] step 5/8 t=0.750
[Debug] dit_step5_vt: [3000, 64] first4: -0.459839 2.119385 -1.070679 1.327881
[Debug] dit_step5_xt: [3000, 64] first4: 0.361111 1.120822 0.403147 -0.055323
[DiT] step 6/8 t=0.643
[Debug] dit_step6_vt: [3000, 64] first4: -0.289917 1.900635 -1.070679 1.070068
[Debug] dit_step6_xt: [3000, 64] first4: 0.419094 0.740695 0.617283 -0.269337
[DiT] step 7/8 t=0.500
[Debug] dit_step7_vt: [3000, 64] first4: -0.248901 1.806885 -1.164429 0.945068
[Debug] dit_x0: [3000, 64] first4: 0.493764 0.198630 0.966612 -0.552857
[DiT] step 8/8 t=0.300
[DiT] Total generation: 317.3 ms
[Output] shape: [3000, 64], first 8 values: 0.493764 0.198630 0.966612 -0.552857 0.709866 0.798022 -0.093181 -0.036291
[Output] mean=-0.083561, std=1.037757
[Debug] dit_output: [3000, 64] first4: 0.493764 0.198630 0.966612 -0.552857
[VAE] Decoding...
[Safetensors] /mnt/workspace/acestep.cpp/checkpoints/vae/diffusion_pytorch_model.safetensors: 365 tensors
[VAE] Loaded safetensors: 365 tensors
[Load] VAE backend: CUDA0
[VAE] Backend: CUDA0, Weight buffer: 321.9 MB
[VAE] Loaded: 5 blocks, upsample=1920x
[Load] VAE weights: 354.4 ms
[VAE] Tiled decode: 24 tiles (chunk=256, overlap=64, stride=128)
[VAE] Graph: 506 nodes, output ne=[368640, 2]
[VAE] Decoded: T_latent=192 -> T_audio=368640 (7.68s @ 48kHz)
[VAE] Upsample factor: 1920.00 (expected ~1920)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[476160, 2]
[VAE] Decoded: T_latent=248 -> T_audio=476160 (9.92s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[230400, 2]
[VAE] Decoded: T_latent=120 -> T_audio=230400 (4.80s @ 48kHz)
[VAE] Tiled decode done: 24 tiles -> T_audio=5760000 (120.00s @ 48kHz)
[VAE] Decode: 2739.4 ms
[VAE] Anti-clip normalize: peak=1.495 -> 1.0
[VAE] Wrote /mnt/workspace/acestep.cpp/tests/ggml-turbo/output.wav: 5760000 samples (120.00s @ 48kHz stereo)
[Debug] vae_audio: [2, 5760000] first4: 0.000386 0.000608 0.000410 0.000933
[Pipeline] OK
2026-02-16 13:54:31.103 | WARNING  | acestep.training.lora_utils:<module>:31 - PEFT library not installed. LoRA training will not be available.
2026-02-16 13:54:31.103 | WARNING  | acestep.training.lokr_utils:<module>:23 - LyCORIS library not installed. LoKr training/inference unavailable. Install with: pip install lycoris-lora
2026-02-16 13:54:31.104 | WARNING  | acestep.training.data_module:<module>:23 - Lightning not installed. Training module will not be available.
2026-02-16 13:54:31.104 | WARNING  | acestep.training.trainer:<module>:28 - Lightning Fabric not installed. Training will use basic training loop.
2026-02-16 13:54:31.104 | WARNING  | acestep.training.trainer:<module>:36 - bitsandbytes not installed. Using standard AdamW.
2026-02-16 13:54:31.107 | INFO     | acestep.handler:initialize_service:723 - [initialize_service] Attempting to load model with attention implementation: sdpa
`torch_dtype` is deprecated! Use `dtype` instead!
2026-02-16 13:54:33.233 | INFO     | acestep.handler:generate_music:1651 - [generate_music] Starting generation...
2026-02-16 13:54:33.233 | INFO     | acestep.handler:generate_music:1654 - [generate_music] Preparing inputs...
2026-02-16 13:54:33.259 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:85 - 
======================================================================
2026-02-16 13:54:33.259 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:86 - üîç [DEBUG] DiT TEXT ENCODER INPUT (Inference)
2026-02-16 13:54:33.259 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:87 - ======================================================================
2026-02-16 13:54:33.259 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:88 - text_prompt:
# Instruction
Generate audio semantic tokens based on the given conditions:

# Caption
Upbeat pop rock anthem with driving electric guitars, punchy drums, catchy vocal hooks, and a singalong chorus

# Metas
- bpm: 120
- timesignature: N/A
- keyscale: N/A
- duration: 120 seconds
<|endoftext|>

2026-02-16 13:54:33.259 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:89 - ======================================================================
2026-02-16 13:54:33.259 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:90 - lyrics_text:
# Languages
en

# Lyric
[verse]
We ride the lightning through the night
Chasing echoes burning bright
[chorus]
We are the fire we are the flame
Nothing will ever be the same<|endoftext|>
2026-02-16 13:54:33.259 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:91 - ======================================================================

2026-02-16 13:54:33.266 | INFO     | acestep.core.generation.handler.conditioning_embed:preprocess_batch:110 - [preprocess_batch] Inferring prompt embeddings...
2026-02-16 13:54:33.356 | INFO     | acestep.core.generation.handler.conditioning_embed:preprocess_batch:113 - [preprocess_batch] Inferring lyric embeddings...
2026-02-16 13:54:33.356 | INFO     | acestep.core.generation.handler.service_generate_execute:_execute_service_generate_diffusion:120 - [service_generate] Generating audio... (DiT backend: PyTorch (cuda))
2026-02-16 13:54:33.411 | INFO     | acestep.core.generation.handler.service_generate_execute:_execute_service_generate_diffusion:193 - [service_generate] DiT diffusion via PyTorch (cuda)...
2026-02-16 13:54:33.791 | INFO     | acestep.handler:generate_music:1717 - [generate_music] Model generation completed. Decoding latents...
2026-02-16 13:54:33.792 | DEBUG    | acestep.handler:generate_music:1736 - [generate_music] pred_latents: torch.Size([1, 3000, 64]), dtype=torch.bfloat16
2026-02-16 13:54:33.792 | DEBUG    | acestep.handler:generate_music:1737 - [generate_music] time_costs: {'encoder_time_cost': 0.01004481315612793, 'diffusion_time_cost': 0.37061381340026855, 'diffusion_per_step_time_cost': 0.04632672667503357, 'total_time_cost': 0.3806586265563965, 'offload_time_cost': 0.0}
2026-02-16 13:54:33.810 | INFO     | acestep.handler:generate_music:1754 - [generate_music] Decoding latents with VAE...
2026-02-16 13:54:33.812 | DEBUG    | acestep.handler:generate_music:1781 - [generate_music] Before VAE decode: allocated=6.00GB, max=7.29GB
2026-02-16 13:54:33.812 | INFO     | acestep.handler:generate_music:1800 - [generate_music] Effective free VRAM before VAE decode: 87.46 GB
2026-02-16 13:54:33.812 | INFO     | acestep.handler:generate_music:1813 - [generate_music] Using tiled VAE decode to reduce VRAM usage...
2026-02-16 13:54:33.812 | DEBUG    | acestep.core.generation.handler.memory_utils:_get_auto_decode_chunk_size:75 - [_get_auto_decode_chunk_size] Effective free VRAM: 87.46 GB
2026-02-16 13:54:33.812 | DEBUG    | acestep.core.generation.handler.memory_utils:_should_offload_wav_to_cpu:98 - [_should_offload_wav_to_cpu] Effective free VRAM: 87.46 GB
2026-02-16 13:54:33.812 | INFO     | acestep.handler:tiled_decode:1104 - [tiled_decode] chunk_size=512, offload_wav_to_cpu=False, latents_shape=torch.Size([1, 64, 3000])
2026-02-16 13:54:34.107 | DEBUG    | acestep.handler:generate_music:1836 - [generate_music] After VAE decode: allocated=6.18GB, max=7.47GB
2026-02-16 13:54:34.216 | INFO     | acestep.handler:generate_music:1857 - [generate_music] VAE decode completed. Preparing audio tensors...
2026-02-16 13:54:34.220 | INFO     | acestep.handler:generate_music:1872 - [generate_music] Done! Generated 1 audio tensors.
[Request] parsed /mnt/workspace/acestep.cpp/tests/ggml-sft/request.json (10 fields)
[Request] task=text2music thinking=false seed=42
  caption:    Upbeat pop rock anthem with driving electric guitars, punchy...
  lyrics:     149 bytes
  bpm=120 dur=120 key= ts= lang=en
  lm: temp=0.85 cfg=2.0 top_p=0.90
  dit: steps=50 guidance=7.0 shift=1.0
  audio_codes: (none)
[Pipeline] No codes, text-to-music from noise
ggml_cuda_init: found 1 CUDA devices:
  Device 0: NVIDIA RTX PRO 6000 Blackwell Workstation Edition, compute capability 12.0, VMM: yes
[Load] DiT backend: CUDA0
[Load] Backend init: 10.3 ms
[Safetensors] /mnt/workspace/acestep.cpp/checkpoints/acestep-v15-sft/model.safetensors: 677 tensors
[Load] DiT safetensors: 677 tensors
[Load] null_condition_emb found (CFG available)
[Safetensors] Loaded 477 tensors, 3005.0 MB into backend
[Load] DiT: 24 layers, H=2048, Nh=16/8, D=128
[Load] DiT weight load: 854.0 ms
[Pipeline] shift=1.0 steps=50: 1.0000 0.9800 0.9600 0.9400 0.9200 0.9000 0.8800 0.8600 0.8400 0.8200 0.8000 0.7800 0.7600 0.7400 0.7200 0.7000 0.6800 0.6600 0.6400 0.6200 0.6000 0.5800 0.5600 0.5400 0.5200 0.5000 0.4800 0.4600 0.4400 0.4200 0.4000 0.3800 0.3600 0.3400 0.3200 0.3000 0.2800 0.2600 0.2400 0.2200 0.2000 0.1800 0.1600 0.1400 0.1200 0.1000 0.0800 0.0600 0.0400 0.0200 
[Pipeline] duration=120.0s, T=3000, S=1500
[BPE] Loaded: 151643 vocab, 151387 merges
[Load] BPE tokenizer: 31.4 ms
[Pipeline] caption: 79 tokens, lyrics: 47 tokens
[Load] TextEncoder backend: CUDA0
[Safetensors] /mnt/workspace/acestep.cpp/checkpoints/Qwen3-Embedding-0.6B/model.safetensors: 310 tensors
[Load] Qwen3 safetensors: 310 tensors
[Safetensors] Loaded 310 tensors, 1136.4 MB into backend
[Load] TextEncoder: 28L, H=1024, Nh=16/8
[Load] TextEncoder: 377.3 ms
[Encode] TextEncoder (79 tokens): 65.1 ms
[Debug] text_hidden: [79, 1024] first4: 3.655793 1.049502 0.218936 -13.003498
[Safetensors] /mnt/workspace/acestep.cpp/checkpoints/Qwen3-Embedding-0.6B/model.safetensors: 310 tensors
[Encode] Lyric vocab lookup (47 tokens): 0.2 ms
[Debug] lyric_embed: [47, 1024] first4: 0.029175 0.032227 -0.022339 -0.028809
[Load] CondEncoder backend: CUDA0
[Safetensors] /mnt/workspace/acestep.cpp/checkpoints/acestep-v15-sft/model.safetensors: 677 tensors
[Safetensors] Loaded 140 tensors, 1160.4 MB into backend
[Load] CondEncoder: lyric(8L), timbre(4L), text_proj, null_cond
[Load] ConditionEncoder: 316.2 ms
[Encode] Packed: lyric=47 + timbre=1 + text=79 = 127 tokens
[Encode] ConditionEncoder: 15.9 ms
[Debug] enc_hidden: [127, 2048] first4: 0.690488 -0.102838 -0.123505 0.014012
[Context] loaded silence_latent: [15000, 64] (using first 3000 frames)
[Context] loaded noise from /mnt/workspace/acestep.cpp/tests/rng_philox_seed42.bf16: [3000, 64] bf16 (time-major, T_file=3000)
[Context] context: [3000, 128], noise: [3000, 64], enc: [127, 2048]
[Debug] noise: [3000, 64] first4: 0.194336 2.156250 -0.171875 0.847656
[Debug] context: [3000, 128] first4: 0.570690 0.098214 0.690920 -0.565790
[DiT] Starting flow matching: T=3000, S=1500, enc_S=127, steps=50
[DiT] Graph: 1764 nodes
[DiT] null_condition_emb: type=30, ne=[2048,1,1], n_elements=2048
[Debug] null_condition_emb: [2048] first4: 0.018066 -0.000360 0.005096 -0.000683
[Debug] null_enc_hidden: [127, 2048] first4: 0.018066 -0.000360 0.005096 -0.000683
[DiT] CFG enabled: guidance_scale=7.0, 2x forward per step
[Debug] tproj: [12288] first4: 0.154506 -0.116116 -0.086937 0.082315
[Debug] temb: [2048] first4: -0.002757 -0.176460 0.004187 -0.001983
[Debug] temb_t: [2048] first4: -0.001235 0.003330 -0.013135 -0.002086
[Debug] temb_r: [2048] first4: -0.001522 -0.179790 0.017322 0.000103
[Debug] sinusoidal_t: [256] first4: 0.562379 0.789627 0.439928 -0.023645
[Debug] sinusoidal_r: [256] first4: 1.000000 1.000000 1.000000 1.000000
[Debug] temb_lin1_t: [2048] first4: -0.039238 0.029644 0.028281 -0.024901
[Debug] temb_lin1_r: [2048] first4: 0.002274 0.002999 -0.001040 -0.000388
[Debug] hidden_after_proj_in: [2048, 1500] first4: -0.283203 0.192627 -0.297607 0.161652
[Debug] proj_in_input: [192, 3000] first4: 0.570690 0.098214 0.690920 -0.565790
[Debug] enc_after_cond_emb: [2048, 127] first4: -0.045227 -0.020859 0.088013 -0.241699
[Debug] layer0_sa_input: [2048, 1500] first4: -0.063004 -0.034217 -0.140855 0.165323
[Debug] layer0_q_after_rope: [128, 24000] first4: -0.315587 -0.166578 0.618825 0.720512
[Debug] layer0_k_after_rope: [128, 12000] first4: -0.137712 -0.329653 0.202073 -0.410678
[Debug] layer0_sa_output: [2048, 1500] first4: -1.218750 0.933594 -0.675781 0.201172
[Debug] layer0_attn_out: [2048, 1500] first4: -0.810892 -0.336312 -1.061206 0.139062
[Debug] layer0_after_self_attn: [2048, 1500] first4: -0.810892 -0.336312 -1.061206 0.139062
[Debug] layer0_after_cross_attn: [2048, 1500] first4: -1.002298 0.023063 -1.283862 0.052148
[Debug] hidden_after_layer0: [2048, 1500] first4: -11.584924 3.618006 80.942459 -1.984098
[Debug] hidden_after_layer6: [2048, 1500] first4: -25.017853 -7.349955 82.050613 -6.533677
[Debug] hidden_after_layer12: [2048, 1500] first4: -12.901888 -23.846781 14.911179 19.497652
[Debug] hidden_after_layer18: [2048, 1500] first4: -16.391140 0.751218 -24.335566 -10.611519
[Debug] hidden_after_layer23: [2048, 1500] first4: -39.669727 -9.133928 62.060665 -4.201240
[Debug] dit_step0_vt_cond: [3000, 64] first4: -0.097900 2.243652 -0.743896 1.444336
[Debug] dit_step0_vt_uncond: [3000, 64] first4: -0.017822 2.017090 -0.974365 1.577148
[Debug] dit_step0_vt: [3000, 64] first4: -0.441867 3.890798 -0.501937 1.231745
[Debug] dit_step0_xt: [3000, 64] first4: 0.203173 2.078434 -0.161836 0.823021
[DiT] step 1/50 t=1.000
[Debug] dit_step1_vt_cond: [3000, 64] first4: -0.114502 2.134277 -0.732178 1.256836
[Debug] dit_step1_vt_uncond: [3000, 64] first4: 0.025513 1.938965 -0.818115 1.499023
[Debug] dit_step1_vt: [3000, 64] first4: -0.600492 2.275652 -0.981265 0.460889
[Debug] dit_step1_xt: [3000, 64] first4: 0.215183 2.032921 -0.142211 0.813804
[DiT] step 2/50 t=0.980
[Debug] dit_step2_vt_cond: [3000, 64] first4: -0.046143 2.071777 -0.548584 1.233398
[Debug] dit_step2_vt_uncond: [3000, 64] first4: -0.023193 1.915527 -0.892334 1.420898
[Debug] dit_step2_vt: [3000, 64] first4: 0.049616 3.008290 0.263469 0.954081
[Debug] dit_step2_xt: [3000, 64] first4: 0.214191 1.972755 -0.147480 0.794722
[DiT] step 3/50 t=0.960
[Debug] dit_step3_vt_cond: [3000, 64] first4: -0.067139 2.056152 -0.275146 1.217773
[Debug] dit_step3_vt_uncond: [3000, 64] first4: -0.105713 1.978027 -0.974365 1.483398
[Debug] dit_step3_vt: [3000, 64] first4: -0.013899 1.918382 1.517424 0.109469
[Debug] dit_step3_xt: [3000, 64] first4: 0.214469 1.934387 -0.177829 0.792533
[DiT] step 4/50 t=0.940
[Debug] dit_step4_vt_cond: [3000, 64] first4: -0.064697 2.040527 -0.223389 1.186523
[Debug] dit_step4_vt_uncond: [3000, 64] first4: -0.050049 1.876465 -0.904053 1.436523
[Debug] dit_step4_vt: [3000, 64] first4: -0.139573 3.097439 0.670493 0.818185
[Debug] dit_step4_xt: [3000, 64] first4: 0.217260 1.872439 -0.191239 0.776169
[DiT] step 5/50 t=0.920
[Debug] dit_step5_vt_cond: [3000, 64] first4: -0.060791 1.954590 -0.257568 1.170898
[Debug] dit_step5_vt_uncond: [3000, 64] first4: -0.016357 1.821777 -0.755615 1.397461
[Debug] dit_step5_vt: [3000, 64] first4: -0.173138 1.887579 0.350188 0.468198
[Debug] dit_step5_xt: [3000, 64] first4: 0.220723 1.834687 -0.198242 0.766805
[DiT] step 6/50 t=0.900
[Debug] dit_step6_vt_cond: [3000, 64] first4: -0.043701 1.899902 -0.333740 1.163086
[Debug] dit_step6_vt_uncond: [3000, 64] first4: 0.091064 1.743652 -0.677490 1.389648
[Debug] dit_step6_vt: [3000, 64] first4: -0.425398 2.641158 0.142295 0.730374
[Debug] dit_step6_xt: [3000, 64] first4: 0.229231 1.781864 -0.201088 0.752197
[DiT] step 7/50 t=0.880
[Debug] dit_step7_vt_cond: [3000, 64] first4: -0.025146 1.806152 -0.378662 1.178711
[Debug] dit_step7_vt_uncond: [3000, 64] first4: 0.106201 1.673340 -0.661865 1.405273
[Debug] dit_step7_vt: [3000, 64] first4: -0.196837 1.801371 0.015069 0.657451
[Debug] dit_step7_xt: [3000, 64] first4: 0.233168 1.745836 -0.201390 0.739048
[DiT] step 8/50 t=0.860
[Debug] dit_step8_vt_cond: [3000, 64] first4: 0.017822 1.751465 -0.431396 1.178711
[Debug] dit_step8_vt_uncond: [3000, 64] first4: 0.133545 1.603027 -0.685303 1.413086
[Debug] dit_step8_vt: [3000, 64] first4: -0.314469 2.376336 -0.031054 0.635189
[Debug] dit_step8_xt: [3000, 64] first4: 0.239457 1.698310 -0.200769 0.726345
[DiT] step 9/50 t=0.840
[Debug] dit_step9_vt_cond: [3000, 64] first4: 0.035400 1.649902 -0.447021 1.194336
[Debug] dit_step9_vt_uncond: [3000, 64] first4: 0.160889 1.509277 -0.618896 1.405273
[Debug] dit_step9_vt: [3000, 64] first4: -0.247083 1.770233 -0.239879 0.686578
[Debug] dit_step9_xt: [3000, 64] first4: 0.244399 1.662905 -0.195971 0.712613
[DiT] step 10/50 t=0.820
[Debug] dit_step10_vt_cond: [3000, 64] first4: 0.040771 1.571777 -0.454834 1.225586
[Debug] dit_step10_vt_uncond: [3000, 64] first4: 0.190186 1.431152 -0.548584 1.366211
[Debug] dit_step10_vt: [3000, 64] first4: -0.398455 2.069022 -0.294291 0.972663
[Debug] dit_step10_xt: [3000, 64] first4: 0.252368 1.621524 -0.190085 0.693160
[DiT] step 11/50 t=0.800
[Debug] dit_step11_vt_cond: [3000, 64] first4: 0.031494 1.478027 -0.443115 1.225586
[Debug] dit_step11_vt_uncond: [3000, 64] first4: 0.194092 1.345215 -0.413818 1.319336
[Debug] dit_step11_vt: [3000, 64] first4: -0.389137 1.658058 -0.664973 0.961565
[Debug] dit_step11_xt: [3000, 64] first4: 0.260151 1.588363 -0.176786 0.673928
[DiT] step 12/50 t=0.780
[Debug] dit_step12_vt_cond: [3000, 64] first4: 0.011963 1.392090 -0.447021 1.249023
[Debug] dit_step12_vt_uncond: [3000, 64] first4: 0.184326 1.306152 -0.366943 1.295898
[Debug] dit_step12_vt: [3000, 64] first4: -0.487717 1.594433 -0.549009 1.192122
[Debug] dit_step12_xt: [3000, 64] first4: 0.269905 1.556475 -0.165806 0.650086
[DiT] step 13/50 t=0.760
[Debug] dit_step13_vt_cond: [3000, 64] first4: 0.012939 1.313965 -0.406006 1.209961
[Debug] dit_step13_vt_uncond: [3000, 64] first4: 0.155029 1.274902 -0.302490 1.272461
[Debug] dit_step13_vt: [3000, 64] first4: -0.291497 1.238986 -0.729262 0.874298
[Debug] dit_step13_xt: [3000, 64] first4: 0.275735 1.531695 -0.151220 0.632600
[DiT] step 14/50 t=0.740
[Debug] dit_step14_vt_cond: [3000, 64] first4: 0.048584 1.259277 -0.384521 1.225586
[Debug] dit_step14_vt_uncond: [3000, 64] first4: 0.115967 1.259277 -0.281006 1.249023
[Debug] dit_step14_vt: [3000, 64] first4: -0.058902 1.182285 -0.576981 1.314138
[Debug] dit_step14_xt: [3000, 64] first4: 0.276913 1.508049 -0.139681 0.606317
[DiT] step 15/50 t=0.720
[Debug] dit_step15_vt_cond: [3000, 64] first4: 0.082275 1.181152 -0.300537 1.217773
[Debug] dit_step15_vt_uncond: [3000, 64] first4: 0.117920 1.188965 -0.253662 1.225586
[Debug] dit_step15_vt: [3000, 64] first4: -0.031128 1.084796 -0.368759 1.063203
[Debug] dit_step15_xt: [3000, 64] first4: 0.277535 1.486353 -0.132306 0.585053
[DiT] step 16/50 t=0.700
[Debug] dit_step16_vt_cond: [3000, 64] first4: 0.110596 1.063965 -0.245850 1.202148
[Debug] dit_step16_vt_uncond: [3000, 64] first4: 0.147217 1.063965 -0.204834 1.194336
[Debug] dit_step16_vt: [3000, 64] first4: -0.025779 1.041186 -0.407502 1.333571
[Debug] dit_step16_xt: [3000, 64] first4: 0.278051 1.465530 -0.124155 0.558382
[DiT] step 17/50 t=0.680
[Debug] dit_step17_vt_cond: [3000, 64] first4: 0.117432 0.954590 -0.165771 1.186523
[Debug] dit_step17_vt_uncond: [3000, 64] first4: 0.158936 0.962402 -0.164795 1.163086
[Debug] dit_step17_vt: [3000, 64] first4: -0.030614 0.851147 -0.051920 1.208384
[Debug] dit_step17_xt: [3000, 64] first4: 0.278663 1.448507 -0.123117 0.534214
[DiT] step 18/50 t=0.660
[Debug] dit_step18_vt_cond: [3000, 64] first4: 0.141357 0.845215 -0.128662 1.155273
[Debug] dit_step18_vt_uncond: [3000, 64] first4: 0.190186 0.821777 -0.118896 1.131836
[Debug] dit_step18_vt: [3000, 64] first4: -0.042654 1.005656 -0.268321 1.269566
[Debug] dit_step18_xt: [3000, 64] first4: 0.279516 1.428394 -0.117751 0.508823
[DiT] step 19/50 t=0.640
[Debug] dit_step19_vt_cond: [3000, 64] first4: 0.153076 0.759277 -0.089111 1.131836
[Debug] dit_step19_vt_uncond: [3000, 64] first4: 0.200928 0.716309 -0.087646 1.084961
[Debug] dit_step19_vt: [3000, 64] first4: -0.000515 0.850271 0.012186 1.322783
[Debug] dit_step19_xt: [3000, 64] first4: 0.279527 1.411388 -0.117994 0.482367
[DiT] step 20/50 t=0.620
[Debug] dit_step20_vt_cond: [3000, 64] first4: 0.164795 0.665527 -0.047607 1.092773
[Debug] dit_step20_vt_uncond: [3000, 64] first4: 0.219482 0.595215 -0.059326 1.069336
[Debug] dit_step20_vt: [3000, 64] first4: -0.050580 0.985073 -0.057926 1.096708
[Debug] dit_step20_xt: [3000, 64] first4: 0.280538 1.391687 -0.116836 0.460433
[DiT] step 21/50 t=0.600
[Debug] dit_step21_vt_cond: [3000, 64] first4: 0.167725 0.571777 -0.012207 1.061523
[Debug] dit_step21_vt_uncond: [3000, 64] first4: 0.231201 0.493652 -0.030640 1.030273
[Debug] dit_step21_vt: [3000, 64] first4: -0.052458 0.774898 0.099182 1.249422
[Debug] dit_step21_xt: [3000, 64] first4: 0.281587 1.376189 -0.118819 0.435445
[DiT] step 22/50 t=0.580
[Debug] dit_step22_vt_cond: [3000, 64] first4: 0.162842 0.487793 0.014404 1.038086
[Debug] dit_step22_vt_uncond: [3000, 64] first4: 0.229248 0.392090 -0.017944 0.991211
[Debug] dit_step22_vt: [3000, 64] first4: -0.070506 0.889947 0.105183 1.187178
[Debug] dit_step22_xt: [3000, 64] first4: 0.282998 1.358390 -0.120923 0.411701
[DiT] step 23/50 t=0.560
[Debug] dit_step23_vt_cond: [3000, 64] first4: 0.147217 0.399902 0.041748 1.022461
[Debug] dit_step23_vt_uncond: [3000, 64] first4: 0.228271 0.317871 0.007080 0.959961
[Debug] dit_step23_vt: [3000, 64] first4: -0.163269 0.575927 0.163069 1.291381
[Debug] dit_step23_xt: [3000, 64] first4: 0.286263 1.346871 -0.124184 0.385873
[DiT] step 24/50 t=0.540
[Debug] dit_step24_vt_cond: [3000, 64] first4: 0.131104 0.329590 0.056885 0.987305
[Debug] dit_step24_vt_uncond: [3000, 64] first4: 0.210693 0.241699 0.018555 0.916992
[Debug] dit_step24_vt: [3000, 64] first4: -0.112170 0.713520 0.188421 1.214557
[Debug] dit_step24_xt: [3000, 64] first4: 0.288506 1.332601 -0.127953 0.361582
[DiT] step 25/50 t=0.520
[Debug] dit_step25_vt_cond: [3000, 64] first4: 0.115967 0.251465 0.091064 0.971680
[Debug] dit_step25_vt_uncond: [3000, 64] first4: 0.195068 0.182129 0.043213 0.881836
[Debug] dit_step25_vt: [3000, 64] first4: -0.174822 0.370867 0.278855 1.348471
[Debug] dit_step25_xt: [3000, 64] first4: 0.292003 1.325184 -0.133530 0.334613
[DiT] step 26/50 t=0.500
[Debug] dit_step26_vt_cond: [3000, 64] first4: 0.118896 0.171387 0.105713 0.920898
[Debug] dit_step26_vt_uncond: [3000, 64] first4: 0.183350 0.123535 0.045166 0.850586
[Debug] dit_step26_vt: [3000, 64] first4: -0.048406 0.363137 0.330521 1.070167
[Debug] dit_step26_xt: [3000, 64] first4: 0.292971 1.317921 -0.140140 0.313210
[DiT] step 27/50 t=0.480
[Debug] dit_step27_vt_cond: [3000, 64] first4: 0.115479 0.076172 0.141846 0.909180
[Debug] dit_step27_vt_uncond: [3000, 64] first4: 0.166748 0.049072 0.060303 0.819336
[Debug] dit_step27_vt: [3000, 64] first4: -0.064972 0.091760 0.465372 1.349572
[Debug] dit_step27_xt: [3000, 64] first4: 0.294270 1.316086 -0.149448 0.286218
[DiT] step 28/50 t=0.460
[Debug] dit_step28_vt_cond: [3000, 64] first4: 0.128174 -0.022949 0.155518 0.877930
[Debug] dit_step28_vt_uncond: [3000, 64] first4: 0.164795 -0.042969 0.072021 0.772461
[Debug] dit_step28_vt: [3000, 64] first4: 0.044951 0.085014 0.418246 1.190903
[Debug] dit_step28_xt: [3000, 64] first4: 0.293371 1.314385 -0.157813 0.262400
[DiT] step 29/50 t=0.440
[Debug] dit_step29_vt_cond: [3000, 64] first4: 0.114990 -0.103027 0.161377 0.870117
[Debug] dit_step29_vt_uncond: [3000, 64] first4: 0.144287 -0.135254 0.107666 0.752930
[Debug] dit_step29_vt: [3000, 64] first4: 0.003690 0.010618 0.291601 1.352854
[Debug] dit_step29_xt: [3000, 64] first4: 0.293298 1.314173 -0.163645 0.235343
[DiT] step 30/50 t=0.420
[Debug] dit_step30_vt_cond: [3000, 64] first4: 0.107666 -0.181152 0.193604 0.854492
[Debug] dit_step30_vt_uncond: [3000, 64] first4: 0.130615 -0.223145 0.116455 0.717773
[Debug] dit_step30_vt: [3000, 64] first4: 0.055168 -0.011372 0.565144 1.325975
[Debug] dit_step30_xt: [3000, 64] first4: 0.292194 1.314400 -0.174948 0.208823
[DiT] step 31/50 t=0.400
[Debug] dit_step31_vt_cond: [3000, 64] first4: 0.096436 -0.258301 0.189697 0.838867
[Debug] dit_step31_vt_uncond: [3000, 64] first4: 0.103760 -0.311035 0.145752 0.702148
[Debug] dit_step31_vt: [3000, 64] first4: 0.093538 -0.065072 0.181704 1.314439
[Debug] dit_step31_xt: [3000, 64] first4: 0.290323 1.315702 -0.178582 0.182535
[DiT] step 32/50 t=0.380
[Debug] dit_step32_vt_cond: [3000, 64] first4: 0.074219 -0.352051 0.210205 0.846680
[Debug] dit_step32_vt_uncond: [3000, 64] first4: 0.087158 -0.414551 0.187744 0.706055
[Debug] dit_step32_vt: [3000, 64] first4: -0.000396 -0.115982 0.358096 1.341417
[Debug] dit_step32_xt: [3000, 64] first4: 0.290331 1.318022 -0.185744 0.155706
[DiT] step 33/50 t=0.360
[Debug] dit_step33_vt_cond: [3000, 64] first4: 0.044189 -0.430176 0.200439 0.819336
[Debug] dit_step33_vt_uncond: [3000, 64] first4: 0.050781 -0.514160 0.218994 0.702148
[Debug] dit_step33_vt: [3000, 64] first4: 0.060969 -0.095018 -0.014300 1.156210
[Debug] dit_step33_xt: [3000, 64] first4: 0.289112 1.319922 -0.185458 0.132582
[DiT] step 34/50 t=0.340
[Debug] dit_step34_vt_cond: [3000, 64] first4: -0.002197 -0.514160 0.222900 0.784180
[Debug] dit_step34_vt_uncond: [3000, 64] first4: 0.021423 -0.600098 0.248291 0.690430
[Debug] dit_step34_vt: [3000, 64] first4: -0.156083 -0.239545 0.239318 1.092561
[Debug] dit_step34_xt: [3000, 64] first4: 0.292234 1.324713 -0.190244 0.110731
[DiT] step 35/50 t=0.320
[Debug] dit_step35_vt_cond: [3000, 64] first4: -0.033447 -0.576660 0.230713 0.791992
[Debug] dit_step35_vt_uncond: [3000, 64] first4: -0.024170 -0.678223 0.271729 0.698242
[Debug] dit_step35_vt: [3000, 64] first4: 0.026234 -0.162502 -0.019229 1.116563
[Debug] dit_step35_xt: [3000, 64] first4: 0.291709 1.327963 -0.189859 0.088400
[DiT] step 36/50 t=0.300
[Debug] dit_step36_vt_cond: [3000, 64] first4: -0.067627 -0.670410 0.250244 0.784180
[Debug] dit_step36_vt_uncond: [3000, 64] first4: -0.066650 -0.764160 0.304932 0.702148
[Debug] dit_step36_vt: [3000, 64] first4: -0.117164 -0.400067 0.118085 1.014967
[Debug] dit_step36_xt: [3000, 64] first4: 0.294052 1.335964 -0.192221 0.068100
[DiT] step 37/50 t=0.280
[Debug] dit_step37_vt_cond: [3000, 64] first4: -0.120361 -0.732910 0.254150 0.764648
[Debug] dit_step37_vt_uncond: [3000, 64] first4: -0.099854 -0.842285 0.314697 0.682617
[Debug] dit_step37_vt: [3000, 64] first4: -0.204265 -0.256028 -0.001249 1.056533
[Debug] dit_step37_xt: [3000, 64] first4: 0.298137 1.341085 -0.192196 0.046970
[DiT] step 38/50 t=0.260
[Debug] dit_step38_vt_cond: [3000, 64] first4: -0.142822 -0.811035 0.261963 0.745117
[Debug] dit_step38_vt_uncond: [3000, 64] first4: -0.142822 -0.924316 0.328369 0.674805
[Debug] dit_step38_vt: [3000, 64] first4: -0.075075 -0.453738 0.062908 0.908750
[Debug] dit_step38_xt: [3000, 64] first4: 0.299639 1.350159 -0.193454 0.028795
[DiT] step 39/50 t=0.240
[Debug] dit_step39_vt_cond: [3000, 64] first4: -0.186768 -0.896973 0.244385 0.725586
[Debug] dit_step39_vt_uncond: [3000, 64] first4: -0.186768 -0.998535 0.332275 0.678711
[Debug] dit_step39_vt: [3000, 64] first4: -0.229758 -0.513010 -0.126210 0.837428
[Debug] dit_step39_xt: [3000, 64] first4: 0.304234 1.360420 -0.190930 0.012046
[DiT] step 40/50 t=0.220
[Debug] dit_step40_vt_cond: [3000, 64] first4: -0.221924 -0.967285 0.248291 0.702148
[Debug] dit_step40_vt_uncond: [3000, 64] first4: -0.208252 -1.045410 0.332275 0.663086
[Debug] dit_step40_vt: [3000, 64] first4: -0.260748 -0.734649 0.028239 0.795465
[Debug] dit_step40_xt: [3000, 64] first4: 0.309449 1.375113 -0.191495 -0.003863
[DiT] step 41/50 t=0.200
[Debug] dit_step41_vt_cond: [3000, 64] first4: -0.249268 -1.053223 0.242432 0.686523
[Debug] dit_step41_vt_uncond: [3000, 64] first4: -0.241455 -1.123535 0.332275 0.659180
[Debug] dit_step41_vt: [3000, 64] first4: -0.253752 -0.752316 -0.125465 0.716949
[Debug] dit_step41_xt: [3000, 64] first4: 0.314524 1.390159 -0.188986 -0.018202
[DiT] step 42/50 t=0.180
[Debug] dit_step42_vt_cond: [3000, 64] first4: -0.284424 -1.100098 0.226807 0.659180
[Debug] dit_step42_vt_uncond: [3000, 64] first4: -0.262939 -1.178223 0.316650 0.616211
[Debug] dit_step42_vt: [3000, 64] first4: -0.394736 -0.810695 -0.029976 0.829176
[Debug] dit_step42_xt: [3000, 64] first4: 0.322419 1.406373 -0.188386 -0.034786
[DiT] step 43/50 t=0.160
[Debug] dit_step43_vt_cond: [3000, 64] first4: -0.298096 -1.178223 0.232666 0.608398
[Debug] dit_step43_vt_uncond: [3000, 64] first4: -0.264893 -1.232910 0.289307 0.581055
[Debug] dit_step43_vt: [3000, 64] first4: -0.397116 -1.024947 0.093203 0.584818
[Debug] dit_step43_xt: [3000, 64] first4: 0.330361 1.426872 -0.190250 -0.046482
[DiT] step 44/50 t=0.140
[Debug] dit_step44_vt_cond: [3000, 64] first4: -0.313721 -1.240723 0.186768 0.592773
[Debug] dit_step44_vt_uncond: [3000, 64] first4: -0.270752 -1.279785 0.261963 0.530273
[Debug] dit_step44_vt: [3000, 64] first4: -0.479943 -1.103713 -0.150671 0.936543
[Debug] dit_step44_xt: [3000, 64] first4: 0.339960 1.448946 -0.187237 -0.065213
[DiT] step 45/50 t=0.120
[Debug] dit_step45_vt_cond: [3000, 64] first4: -0.307861 -1.279785 0.157471 0.561523
[Debug] dit_step45_vt_uncond: [3000, 64] first4: -0.284424 -1.303223 0.221924 0.497070
[Debug] dit_step45_vt: [3000, 64] first4: -0.307816 -1.238579 0.033633 0.654118
[Debug] dit_step45_xt: [3000, 64] first4: 0.346116 1.473718 -0.187909 -0.078295
[DiT] step 46/50 t=0.100
[Debug] dit_step46_vt_cond: [3000, 64] first4: -0.303955 -1.326660 0.107666 0.534180
[Debug] dit_step46_vt_uncond: [3000, 64] first4: -0.266846 -1.342285 0.148682 0.459961
[Debug] dit_step46_vt: [3000, 64] first4: -0.512323 -1.253187 -0.036875 0.886862
[Debug] dit_step46_xt: [3000, 64] first4: 0.356363 1.498781 -0.187172 -0.096033
[DiT] step 47/50 t=0.080
[Debug] dit_step47_vt_cond: [3000, 64] first4: -0.268799 -1.381348 0.068115 0.487305
[Debug] dit_step47_vt_uncond: [3000, 64] first4: -0.260986 -1.381348 0.102783 0.444336
[Debug] dit_step47_vt: [3000, 64] first4: -0.146208 -1.392867 -0.025749 0.461039
[Debug] dit_step47_xt: [3000, 64] first4: 0.359287 1.526639 -0.186657 -0.105253
[DiT] step 48/50 t=0.060
[Debug] dit_step48_vt_cond: [3000, 64] first4: -0.237549 -1.428223 0.046143 0.465820
[Debug] dit_step48_vt_uncond: [3000, 64] first4: -0.235596 -1.436035 0.074951 0.409180
[Debug] dit_step48_vt: [3000, 64] first4: -0.319149 -1.188259 -0.056262 0.694826
[Debug] dit_step48_xt: [3000, 64] first4: 0.365670 1.550404 -0.185532 -0.119150
[DiT] step 49/50 t=0.040
[Debug] dit_step49_vt_cond: [3000, 64] first4: -0.227783 -1.451660 0.026855 0.461914
[Debug] dit_step49_vt_uncond: [3000, 64] first4: -0.241455 -1.451660 0.041260 0.440430
[Debug] dit_step49_vt: [3000, 64] first4: -0.071214 -1.457591 0.020417 0.358093
[Debug] dit_x0: [3000, 64] first4: 0.367094 1.579556 -0.185940 -0.126312
[DiT] step 50/50 t=0.020
[DiT] Total generation: 3422.0 ms
[Output] shape: [3000, 64], first 8 values: 0.367094 1.579556 -0.185940 -0.126312 -0.771266 0.481866 -1.684114 -0.698023
[Output] mean=0.019759, std=0.747236
[Debug] dit_output: [3000, 64] first4: 0.367094 1.579556 -0.185940 -0.126312
[VAE] Decoding...
[Safetensors] /mnt/workspace/acestep.cpp/checkpoints/vae/diffusion_pytorch_model.safetensors: 365 tensors
[VAE] Loaded safetensors: 365 tensors
[Load] VAE backend: CUDA0
[VAE] Backend: CUDA0, Weight buffer: 321.9 MB
[VAE] Loaded: 5 blocks, upsample=1920x
[Load] VAE weights: 371.7 ms
[VAE] Tiled decode: 24 tiles (chunk=256, overlap=64, stride=128)
[VAE] Graph: 506 nodes, output ne=[368640, 2]
[VAE] Decoded: T_latent=192 -> T_audio=368640 (7.68s @ 48kHz)
[VAE] Upsample factor: 1920.00 (expected ~1920)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[491520, 2]
[VAE] Decoded: T_latent=256 -> T_audio=491520 (10.24s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[476160, 2]
[VAE] Decoded: T_latent=248 -> T_audio=476160 (9.92s @ 48kHz)
[VAE] Graph: 506 nodes, output ne=[230400, 2]
[VAE] Decoded: T_latent=120 -> T_audio=230400 (4.80s @ 48kHz)
[VAE] Tiled decode done: 24 tiles -> T_audio=5760000 (120.00s @ 48kHz)
[VAE] Decode: 2744.9 ms
[VAE] Anti-clip normalize: peak=1.070 -> 1.0
[VAE] Wrote /mnt/workspace/acestep.cpp/tests/ggml-sft/output.wav: 5760000 samples (120.00s @ 48kHz stereo)
[Debug] vae_audio: [2, 5760000] first4: -0.000192 0.000213 0.000250 0.000869
[Pipeline] OK
2026-02-16 13:54:43.258 | INFO     | acestep.handler:initialize_service:723 - [initialize_service] Attempting to load model with attention implementation: sdpa
2026-02-16 13:54:45.373 | INFO     | acestep.handler:generate_music:1651 - [generate_music] Starting generation...
2026-02-16 13:54:45.373 | INFO     | acestep.handler:generate_music:1654 - [generate_music] Preparing inputs...
2026-02-16 13:54:45.391 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:85 - 
======================================================================
2026-02-16 13:54:45.391 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:86 - üîç [DEBUG] DiT TEXT ENCODER INPUT (Inference)
2026-02-16 13:54:45.391 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:87 - ======================================================================
2026-02-16 13:54:45.391 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:88 - text_prompt:
# Instruction
Generate audio semantic tokens based on the given conditions:

# Caption
Upbeat pop rock anthem with driving electric guitars, punchy drums, catchy vocal hooks, and a singalong chorus

# Metas
- bpm: 120
- timesignature: N/A
- keyscale: N/A
- duration: 120 seconds
<|endoftext|>

2026-02-16 13:54:45.391 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:89 - ======================================================================
2026-02-16 13:54:45.391 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:90 - lyrics_text:
# Languages
en

# Lyric
[verse]
We ride the lightning through the night
Chasing echoes burning bright
[chorus]
We are the fire we are the flame
Nothing will ever be the same<|endoftext|>
2026-02-16 13:54:45.391 | INFO     | acestep.core.generation.handler.conditioning_text:_prepare_text_conditioning_inputs:91 - ======================================================================

2026-02-16 13:54:45.395 | INFO     | acestep.core.generation.handler.conditioning_embed:preprocess_batch:110 - [preprocess_batch] Inferring prompt embeddings...
2026-02-16 13:54:45.404 | INFO     | acestep.core.generation.handler.conditioning_embed:preprocess_batch:113 - [preprocess_batch] Inferring lyric embeddings...
2026-02-16 13:54:45.404 | INFO     | acestep.core.generation.handler.service_generate_execute:_execute_service_generate_diffusion:120 - [service_generate] Generating audio... (DiT backend: PyTorch (cuda))
2026-02-16 13:54:45.414 | INFO     | acestep.core.generation.handler.service_generate_execute:_execute_service_generate_diffusion:193 - [service_generate] DiT diffusion via PyTorch (cuda)...
[Noise] Generating T=3000 (duration=120s)...
[Noise] Generated /mnt/workspace/acestep.cpp/tests/rng_philox_seed42.bf16: [3000, 64] bf16 (384000 bytes, seed=42)
[Turbo] steps=8, shift=3.0
[GGML] Running acestep-v15-turbo...
[GGML] Done, 46 dump files
[Python] Initializing acestep-v15-turbo...
[Python] Generating (acestep-v15-turbo, 8 steps)...
[Python] Wrote /mnt/workspace/acestep.cpp/tests/python-turbo/output.wav: 5760000 samples (120.00s @ 48kHz stereo)
[Python] Done, 39 dump files
[Turbo] Cosine similarities GGML vs Python
  stage                          GGML vs Python
  text_hidden                          0.999796
  lyric_embed                          1.000000
  enc_hidden                           0.999823
  context                              1.000000
  noise                                1.000000
  temb_t                               0.999999
  hidden_after_proj_in                 0.999992
  enc_after_cond_emb                   0.999817
  layer0_sa_output                     0.999951
  hidden_after_layer0                  0.999979
  hidden_after_layer6                  0.999816
  hidden_after_layer12                 0.997514
  hidden_after_layer18                 0.993118
  hidden_after_layer23                 0.987375
  dit_step0_vt                         0.929811
  dit_step0_xt                         0.999879
  dit_step1_vt                         0.941282
  dit_step1_xt                         0.999706
  dit_step2_vt                         0.942485
  dit_step2_xt                         0.999232
  dit_step3_vt                         0.914725
  dit_step3_xt                         0.997235
  dit_step4_vt                         0.905958
  dit_step4_xt                         0.991185
  dit_step5_vt                         0.897079
  dit_step5_xt                         0.974419
  dit_step6_vt                         0.887861
  dit_step6_xt                         0.938634
  dit_step7_vt                         0.866611
  dit_x0                               0.887958
  vae_audio                            0.568206
  vae_audio (log spectral)             0.999322
[Turbo] Error growth GGML vs Python
  stage                         cos    max_err   mean_err     mean_A      std_A     mean_B      std_B
  dit_step0_xt             0.999879   0.214869   0.009458  -0.000518   0.975827  -0.000471   0.975047
  dit_step1_xt             0.999706   0.281204   0.015775  -0.003595   0.945134  -0.003352   0.944230
  dit_step2_xt             0.999232   0.412110   0.024601  -0.008024   0.909001  -0.007674   0.907799
  dit_step3_xt             0.997235   0.900068   0.043742  -0.014583   0.867949  -0.013977   0.866681
  dit_step4_xt             0.991185   1.370004   0.073866  -0.023840   0.826209  -0.023116   0.824698
  dit_step5_xt             0.974419   1.638797   0.121653  -0.036753   0.797006  -0.036400   0.794414
  dit_step6_xt             0.938634   2.399898   0.196049  -0.055263   0.825066  -0.054935   0.825012
[SFT] steps=50, shift=1.0, CFG=7.0
[GGML] Running acestep-v15-sft...
[GGML] Done, 232 dump files
[Python] Initializing acestep-v15-sft...
[Python] Generating (acestep-v15-sft, 50 steps, CFG 7.0)...
  0%|          | 0/50 [00:00<?, ?it/s]  4%|‚ñç         | 2/50 [00:00<00:03, 13.46it/s]  8%|‚ñä         | 4/50 [00:00<00:03, 13.84it/s] 12%|‚ñà‚ñè        | 6/50 [00:00<00:03, 14.59it/s] 16%|‚ñà‚ñå        | 8/50 [00:00<00:02, 14.95it/s] 20%|‚ñà‚ñà        | 10/50 [00:00<00:02, 15.17it/s] 24%|‚ñà‚ñà‚ñç       | 12/50 [00:00<00:02, 15.30it/s] 28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:02, 15.37it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 16/50 [00:01<00:02, 15.42it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:01<00:02, 15.45it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 20/50 [00:01<00:01, 15.48it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 22/50 [00:01<00:01, 15.49it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 24/50 [00:01<00:01, 15.49it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 26/50 [00:01<00:01, 15.50it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:01<00:01, 15.50it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:01<00:01, 15.44it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 32/50 [00:02<00:01, 15.46it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 34/50 [00:02<00:01, 15.47it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 36/50 [00:02<00:00, 15.48it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 38/50 [00:02<00:00, 15.48it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 40/50 [00:02<00:00, 15.49it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:02<00:00, 15.49it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 44/50 [00:02<00:00, 15.49it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 46/50 [00:02<00:00, 15.49it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:03<00:00, 15.49it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:03<00:00, 15.49it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:03<00:00, 15.35it/s]
2026-02-16 13:54:48.686 | INFO     | acestep.handler:generate_music:1717 - [generate_music] Model generation completed. Decoding latents...
2026-02-16 13:54:48.696 | DEBUG    | acestep.handler:generate_music:1736 - [generate_music] pred_latents: torch.Size([1, 3000, 64]), dtype=torch.bfloat16
2026-02-16 13:54:48.696 | DEBUG    | acestep.handler:generate_music:1737 - [generate_music] time_costs: {'encoder_time_cost': 0.01252436637878418, 'diffusion_time_cost': 3.2585511207580566, 'diffusion_per_step_time_cost': 0.06517102241516114, 'total_time_cost': 3.271075487136841, 'offload_time_cost': 0.0}
2026-02-16 13:54:48.697 | INFO     | acestep.handler:generate_music:1754 - [generate_music] Decoding latents with VAE...
2026-02-16 13:54:48.699 | DEBUG    | acestep.handler:generate_music:1781 - [generate_music] Before VAE decode: allocated=12.21GB, max=13.44GB
2026-02-16 13:54:48.700 | INFO     | acestep.handler:generate_music:1800 - [generate_music] Effective free VRAM before VAE decode: 81.46 GB
2026-02-16 13:54:48.700 | INFO     | acestep.handler:generate_music:1813 - [generate_music] Using tiled VAE decode to reduce VRAM usage...
2026-02-16 13:54:48.700 | DEBUG    | acestep.core.generation.handler.memory_utils:_get_auto_decode_chunk_size:75 - [_get_auto_decode_chunk_size] Effective free VRAM: 81.46 GB
2026-02-16 13:54:48.700 | DEBUG    | acestep.core.generation.handler.memory_utils:_should_offload_wav_to_cpu:98 - [_should_offload_wav_to_cpu] Effective free VRAM: 81.46 GB
2026-02-16 13:54:48.700 | INFO     | acestep.handler:tiled_decode:1104 - [tiled_decode] chunk_size=512, offload_wav_to_cpu=False, latents_shape=torch.Size([1, 64, 3000])
2026-02-16 13:54:48.991 | DEBUG    | acestep.handler:generate_music:1836 - [generate_music] After VAE decode: allocated=12.39GB, max=13.68GB
2026-02-16 13:54:49.078 | INFO     | acestep.handler:generate_music:1857 - [generate_music] VAE decode completed. Preparing audio tensors...
2026-02-16 13:54:49.097 | INFO     | acestep.handler:generate_music:1872 - [generate_music] Done! Generated 1 audio tensors.
[Python] Wrote /mnt/workspace/acestep.cpp/tests/python-sft/output.wav: 5760000 samples (120.00s @ 48kHz stereo)
[Python] Done, 217 dump files
[SFT] Cosine similarities GGML vs Python
  stage                          GGML vs Python
  text_hidden                          0.999796
  lyric_embed                          1.000000
  enc_hidden                           0.999823
  context                              1.000000
  noise                                1.000000
  temb_t                               0.999997
  hidden_after_proj_in                 0.999993
  enc_after_cond_emb                   0.999815
  layer0_sa_output                     0.999938
  hidden_after_layer0                  0.999979
  hidden_after_layer6                  0.999733
  hidden_after_layer12                 0.999370
  hidden_after_layer18                 0.999386
  hidden_after_layer23                 0.999865
  null_condition_emb                   1.000000
  null_enc_hidden                      1.000000
  dit_step0_vt_cond                    0.999764
  dit_step0_vt_uncond                  0.999829
  dit_step0_vt                         0.994728
  dit_step0_xt                         0.999998
  dit_step5_vt_cond                    0.979964
  dit_step5_vt                         0.928125
  dit_step5_xt                         0.999690
  dit_step10_vt_cond                   0.940246
  dit_step10_vt                        0.868058
  dit_step10_xt                        0.997590
  dit_step15_vt_cond                   0.907731
  dit_step15_vt                        0.845659
  dit_step15_xt                        0.990742
  dit_step20_vt_cond                   0.874426
  dit_step20_vt                        0.820598
  dit_step20_xt                        0.976330
  dit_step25_vt_cond                   0.824076
  dit_step25_vt                        0.771881
  dit_step25_xt                        0.951965
  dit_step30_vt_cond                   0.757393
  dit_step30_vt                        0.709225
  dit_step30_xt                        0.916609
  dit_step35_vt_cond                   0.687249
  dit_step35_vt                        0.638858
  dit_step35_xt                        0.876835
  dit_step40_vt_cond                   0.653832
  dit_step40_vt                        0.607862
  dit_step40_xt                        0.842624
  dit_step45_vt_cond                   0.708236
  dit_step45_vt                        0.662867
  dit_step45_xt                        0.821667
  dit_step49_vt_cond                   0.746661
  dit_step49_vt                        0.649363
  dit_x0                               0.815287
  vae_audio                            0.498198
  vae_audio (log spectral)             0.999060
[SFT] Error growth GGML vs Python
  stage                         cos    max_err   mean_err     mean_A      std_A     mean_B      std_B
  dit_step0_xt             0.999998   0.032474   0.002099   0.001067   0.979881   0.001002   0.980310
  dit_step5_xt             0.999690   0.216609   0.016339   0.004244   0.887367   0.003712   0.886023
  dit_step10_xt            0.997590   0.508993   0.040371   0.005991   0.801754   0.004704   0.801979
  dit_step15_xt            0.990742   0.944237   0.071294   0.007487   0.725990   0.005392   0.724151
  dit_step20_xt            0.976330   1.294264   0.104482   0.009072   0.663494   0.005899   0.659957
  dit_step25_xt            0.951965   1.676679   0.139564   0.010947   0.619817   0.006418   0.615534
  dit_step30_xt            0.916609   2.092647   0.178704   0.012805   0.600435   0.007069   0.593391
  dit_step35_xt            0.876835   2.529881   0.220367   0.014588   0.608024   0.007770   0.597418
  dit_step40_xt            0.842624   2.974594   0.263075   0.016399   0.640748   0.008615   0.627363
  dit_step45_xt            0.821667   3.410465   0.303667   0.018354   0.693853   0.009677   0.677652
